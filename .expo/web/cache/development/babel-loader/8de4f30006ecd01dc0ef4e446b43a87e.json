{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { useEffect, useState } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { getById } from \"../api/firebase\";\nexport default (function () {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      currentUser = _useState2[0],\n      setCurrentUser = _useState2[1];\n\n  var getUser = function getUser() {\n    var userId, userRole, userName, user;\n    return _regeneratorRuntime.async(function getUser$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem('userId'));\n\n          case 2:\n            userId = _context.sent;\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem('userRole'));\n\n          case 5:\n            userRole = _context.sent;\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem('userName'));\n\n          case 8:\n            userName = _context.sent;\n\n            if (userId && userRole && userName) {\n              _context.next = 22;\n              break;\n            }\n\n            _context.next = 12;\n            return _regeneratorRuntime.awrap(getById('users', userId));\n\n          case 12:\n            user = _context.sent;\n            _context.next = 15;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem('userId', user.id));\n\n          case 15:\n            _context.next = 17;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem('userRole', user.role));\n\n          case 17:\n            _context.next = 19;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem('userName', user.name));\n\n          case 19:\n            setCurrentUser(user);\n            _context.next = 23;\n            break;\n\n          case 22:\n            setCurrentUser({\n              id: userId,\n              role: userRole,\n              name: userName\n            });\n\n          case 23:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    getUser().catch(function (err) {\n      return console.log(\"Error useUser hook: \" + err);\n    });\n  }, []);\n  return currentUser;\n});","map":{"version":3,"sources":["/home/bordi/projects/cestas-cooperflora-rn/src/hooks/useUser.js"],"names":["useEffect","useState","AsyncStorage","getById","currentUser","setCurrentUser","getUser","getItem","userId","userRole","userName","user","setItem","id","role","name","catch","err","console","log"],"mappings":";;AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,OAAOC,YAAP,MAAyB,2CAAzB;AACA,SAASC,OAAT;AAEA,gBAAe,YAAM;AACnB,kBAAsCF,QAAQ,CAAC,IAAD,CAA9C;AAAA;AAAA,MAAOG,WAAP;AAAA,MAAoBC,cAApB;;AAEA,MAAMC,OAAO,GAAG,SAAVA,OAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6CACOJ,YAAY,CAACK,OAAb,CAAqB,QAArB,CADP;;AAAA;AACRC,YAAAA,MADQ;AAAA;AAAA,6CAESN,YAAY,CAACK,OAAb,CAAqB,UAArB,CAFT;;AAAA;AAERE,YAAAA,QAFQ;AAAA;AAAA,6CAGSP,YAAY,CAACK,OAAb,CAAqB,UAArB,CAHT;;AAAA;AAGRG,YAAAA,QAHQ;;AAAA,gBAKRF,MAAM,IAAIC,QAAV,IAAsBC,QALd;AAAA;AAAA;AAAA;;AAAA;AAAA,6CAMOP,OAAO,CAAC,OAAD,EAAUK,MAAV,CANd;;AAAA;AAMNG,YAAAA,IANM;AAAA;AAAA,6CAONT,YAAY,CAACU,OAAb,CAAqB,QAArB,EAA+BD,IAAI,CAACE,EAApC,CAPM;;AAAA;AAAA;AAAA,6CAQNX,YAAY,CAACU,OAAb,CAAqB,UAArB,EAAiCD,IAAI,CAACG,IAAtC,CARM;;AAAA;AAAA;AAAA,6CASNZ,YAAY,CAACU,OAAb,CAAqB,UAArB,EAAiCD,IAAI,CAACI,IAAtC,CATM;;AAAA;AAWZV,YAAAA,cAAc,CAACM,IAAD,CAAd;AAXY;AAAA;;AAAA;AAaZN,YAAAA,cAAc,CAAC;AAAEQ,cAAAA,EAAE,EAAEL,MAAN;AAAcM,cAAAA,IAAI,EAAEL,QAApB;AAA8BM,cAAAA,IAAI,EAAEL;AAApC,aAAD,CAAd;;AAbY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAhB;;AAiBAV,EAAAA,SAAS,CAAC,YAAM;AACdM,IAAAA,OAAO,GAAGU,KAAV,CAAgB,UAACC,GAAD;AAAA,aAASC,OAAO,CAACC,GAAR,0BAAmCF,GAAnC,CAAT;AAAA,KAAhB;AACD,GAFQ,EAEN,EAFM,CAAT;AAIA,SAAOb,WAAP;AACD,CAzBD","sourcesContent":["import { useEffect, useState } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { getById } from '../api/firebase';\n\nexport default () => {\n  const [currentUser, setCurrentUser] = useState(null);\n\n  const getUser = async () => {\n    const userId = await AsyncStorage.getItem('userId');\n    const userRole = await AsyncStorage.getItem('userRole');\n    const userName = await AsyncStorage.getItem('userName');\n\n    if (!(userId && userRole && userName)) {\n      const user = await getById('users', userId);\n      await AsyncStorage.setItem('userId', user.id);\n      await AsyncStorage.setItem('userRole', user.role);\n      await AsyncStorage.setItem('userName', user.name);\n\n      setCurrentUser(user);\n    } else {\n      setCurrentUser({ id: userId, role: userRole, name: userName });\n    }\n  };\n\n  useEffect(() => {\n    getUser().catch((err) => console.log(`Error useUser hook: ${err}`));\n  }, []);\n\n  return currentUser;\n};\n"]},"metadata":{},"sourceType":"module"}