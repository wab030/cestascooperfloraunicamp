{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/bordi/projects/cestas-cooperflora-rn/src/screens/consumer/ConsumerOrderScreen.js\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useContext, useEffect, useState } from 'react';\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { format } from 'date-fns';\nimport { useFocusEffect } from '@react-navigation/native';\nimport GLOBALS from \"../../Globals\";\nimport { Context as OrderContext } from \"../../context/OrderContext\";\nimport { Context as PaymentContext } from \"../../context/PaymentContext\";\nimport { Context as UserContext } from \"../../context/UserContext\";\nimport Colors from \"../../constants/Colors\";\nimport Divider from \"../../components/Divider\";\nimport Button from \"../../components/Button\";\nimport HeaderTitle from \"../../components/HeaderTitle\";\nimport BackArrow from \"../../components/BackArrow\";\nimport VegetableImage from \"../../../assets/images/vegetable2.png\";\nimport Spinner from \"../../components/Spinner\";\nimport { isConsumer, showAlert } from \"../../helper/HelperFunctions\";\nimport { Context as DeliveryContext } from \"../../context/DeliveryContext\";\nimport { Entypo } from '@expo/vector-icons';\n\nvar ConsumerOrderScreen = function ConsumerOrderScreen(_ref) {\n  var _delivery$baseProduct;\n\n  var route = _ref.route,\n      navigation = _ref.navigation;\n  var _route$params = route.params,\n      user = _route$params.user,\n      delivery = _route$params.delivery;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      orderProducts = _useState2[0],\n      setOrderProducts = _useState2[1];\n\n  var _useContext = useContext(OrderContext),\n      _useContext$state = _useContext.state,\n      loading = _useContext$state.loading,\n      order = _useContext$state.order,\n      initialProducts = _useContext$state.initialProducts,\n      addBaseProducts = _useContext.addBaseProducts,\n      removeBaseProducts = _useContext.removeBaseProducts,\n      addProduct = _useContext.addProduct,\n      removeProduct = _useContext.removeProduct,\n      addOrder = _useContext.addOrder,\n      fetchUserOrder = _useContext.fetchUserOrder,\n      completeOrderDelivery = _useContext.completeOrderDelivery;\n\n  var _useContext2 = useContext(UserContext),\n      userLoading = _useContext2.state.loading,\n      findUserById = _useContext2.findUserById;\n\n  var _useContext3 = useContext(PaymentContext),\n      paymentLoading = _useContext3.state.loading,\n      createPaymentForUser = _useContext3.createPaymentForUser;\n\n  var _useContext4 = useContext(DeliveryContext),\n      deliveryLoading = _useContext4.state.loading;\n\n  var formatBaseProducts = function formatBaseProducts(baseProducts) {\n    return baseProducts.toLowerCase().replace(/\\n/g, ', ');\n  };\n\n  var resolveProductAvailableQuantity = function resolveProductAvailableQuantity(product, initialQuantity) {\n    initialQuantity = initialQuantity != null ? initialQuantity : 0;\n\n    if (product.maxOrderQuantity != null && product.availableQuantity != null) {\n      var availableQuantity = product.availableQuantity - product.orderedQuantity;\n      return Math.min(product.maxOrderQuantity, availableQuantity + initialQuantity);\n    }\n\n    if (product.maxOrderQuantity != null && product.availableQuantity == null) {\n      return product.maxOrderQuantity;\n    }\n\n    if (product.availableQuantity != null) {\n      return product.availableQuantity - product.orderedQuantity + initialQuantity;\n    }\n\n    return null;\n  };\n\n  var transformOrderProducts = function transformOrderProducts() {\n    var deliveryExtraProducts = delivery.extraProducts;\n    var orderExtraProducts = order.extraProducts ? order.extraProducts : [];\n    orderExtraProducts.forEach(function (orderProduct) {\n      deliveryExtraProducts.forEach(function (deliveryProduct) {\n        var initialIndex = initialProducts.findIndex(function (prod) {\n          return prod.productId === orderProduct.productId;\n        });\n\n        if (orderProduct.productId === deliveryProduct.id) {\n          orderProduct.maxQuantity = initialProducts.length > 0 && initialProducts[initialIndex] != null ? resolveProductAvailableQuantity(deliveryProduct, initialProducts[initialIndex].quantity) : resolveProductAvailableQuantity(deliveryProduct, 0);\n        }\n      });\n    });\n    deliveryExtraProducts.filter(function (deliveryProduct) {\n      var ids = orderExtraProducts.map(function (orderProduct) {\n        return orderProduct.productId;\n      });\n      return !ids.includes(deliveryProduct.id);\n    }).forEach(function (product) {\n      orderExtraProducts.push({\n        productId: product.id,\n        productPrice: product.price,\n        productTitle: product.name,\n        quantity: 0,\n        maxQuantity: resolveProductAvailableQuantity(product)\n      });\n    });\n    var transformedOrderProducts = orderExtraProducts;\n    transformedOrderProducts.sort(function (a, b) {\n      return a.productTitle > b.productTitle ? 1 : -1;\n    });\n    setOrderProducts(transformedOrderProducts);\n  };\n\n  useFocusEffect(React.useCallback(function () {\n    console.log('[Consumer Order Product Screen - useEffect fetch orders');\n\n    if (user && delivery) {\n      if (!user.role || order == null) {\n        console.log(\"[Consumer Order Screen] Fetching order...\");\n        fetchUserOrder(user.id, delivery.id, delivery.extraProducts);\n      }\n\n      navigation.setParams({\n        deliveryDate: format(delivery.deliveryDate, GLOBALS.FORMAT.DD_MM)\n      });\n    }\n  }, [user, delivery]));\n  useEffect(function () {\n    transformOrderProducts();\n  }, [order, delivery]);\n\n  var onHandleNewOrUpdatedOrder = function onHandleNewOrUpdatedOrder() {\n    console.log('[Consumer Order Screen] Handle new or update order');\n    addOrder(user.id, user.name, delivery.id, delivery.deliveryFee, order, initialProducts).then(function () {\n      if (order.productsPriceSum === 0) {\n        showAlert('Seu pedido para esta entrega foi cancelado.');\n        navigation.navigate('DeliveriesScreen');\n        return;\n      }\n\n      if (user.role && user.role === GLOBALS.USER.ROLE.CONSUMER) {\n        navigation.navigate('ConsumerOrderPlacedScreen', {\n          delivery: delivery,\n          user: user\n        });\n      } else {\n        navigation.goBack();\n      }\n    }).catch(function (error) {\n      showAlert(error);\n      fetchUserOrder(user.id, delivery.id, delivery.extraProducts);\n    });\n  };\n\n  var renderConfirmButton = function renderConfirmButton() {\n    var _order$productsPriceS2;\n\n    var buttonDisabled = false;\n\n    if (order.productsPriceSum === 0) {\n      var _order$productsPriceS;\n\n      if (order.deliveryId && order.userId && order.status !== GLOBALS.ORDER.STATUS.CANCELED) {\n        return React.createElement(Button, {\n          id: \"confirmOrderButton\",\n          style: styles.confirmButton,\n          textColor: \"white\",\n          onPress: onHandleNewOrUpdatedOrder,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 11\n          }\n        }, \"Cancelar pedido\");\n      }\n\n      return React.createElement(Button, {\n        id: \"confirmOrderButton\",\n        style: styles.disabledButton,\n        textColor: \"white\",\n        onPress: onHandleNewOrUpdatedOrder,\n        disabled: true,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 9\n        }\n      }, \"Confirmar R$ \", (_order$productsPriceS = order.productsPriceSum) == null ? void 0 : _order$productsPriceS.toFixed(2));\n    }\n\n    return React.createElement(Button, {\n      id: \"confirmOrderButton\",\n      style: styles.confirmButton,\n      textColor: \"white\",\n      onPress: onHandleNewOrUpdatedOrder,\n      disabled: buttonDisabled,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 7\n      }\n    }, \"Confirmar R$ \", (_order$productsPriceS2 = order.productsPriceSum) == null ? void 0 : _order$productsPriceS2.toFixed(2));\n  };\n\n  var completeDelivery = function completeDelivery() {\n    var completedOrder, orderUser;\n    return _regeneratorRuntime.async(function completeDelivery$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(order.id && order.deliveryId && order.userId)) {\n              _context.next = 10;\n              break;\n            }\n\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(completeOrderDelivery(user.id, user.name, delivery.id, delivery.deliveryFee, order));\n\n          case 3:\n            completedOrder = _context.sent;\n            _context.next = 6;\n            return _regeneratorRuntime.awrap(findUserById(order.userId));\n\n          case 6:\n            orderUser = _context.sent;\n            _context.next = 9;\n            return _regeneratorRuntime.awrap(createPaymentForUser(orderUser, completedOrder));\n\n          case 9:\n            navigation.goBack(null);\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var renderCompleteDeliveryButton = function renderCompleteDeliveryButton() {\n    var _delivery$deliveryDat;\n\n    var today = new Date();\n    today.setHours(0, 0, 0, 0);\n    (_delivery$deliveryDat = delivery.deliveryDate) == null ? void 0 : _delivery$deliveryDat.setHours(0, 0, 0, 0);\n\n    if (order.status != null && order.status === GLOBALS.ORDER.STATUS.COMPLETED) {\n      return React.createElement(Button, {\n        style: styles.disabledButton,\n        textColor: \"white\",\n        disabled: true,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 9\n        }\n      }, \"Entrega conclu\\xEDda\");\n    }\n\n    if (today >= delivery.deliveryDate && !user.role && order.productsPriceSum > 0 && order.id) {\n      return React.createElement(Button, {\n        style: styles.completeDeliveryButton,\n        textColor: \"white\",\n        onPress: function onPress() {\n          return completeDelivery();\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 9\n        }\n      }, \"Concluir entrega\");\n    }\n\n    return null;\n  };\n\n  var isLoading = function isLoading() {\n    return !order || !delivery || loading || deliveryLoading || userLoading || paymentLoading;\n  };\n\n  return isLoading() ? React.createElement(Spinner, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 5\n    }\n  }) : React.createElement(View, {\n    style: styles.screen,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: styles.baseProductsContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: styles.baseProducts,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 11\n    }\n  }, React.createElement(View, {\n    style: styles.title,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: styles.textTitle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 15\n    }\n  }, \"Cesta (\" + ((_delivery$baseProduct = delivery.baseProductsPrice) == null ? void 0 : _delivery$baseProduct.toFixed(2)) + \")\")), React.createElement(View, {\n    style: styles.controls,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 13\n    }\n  }, React.createElement(TouchableOpacity, {\n    style: styles.incDecButton,\n    onPress: function onPress() {\n      return removeBaseProducts(delivery.baseProductsPrice);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 15\n    }\n  }, React.createElement(Entypo, {\n    name: \"minus\",\n    size: 24,\n    color: \"#8898AA\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 17\n    }\n  })), React.createElement(View, {\n    style: styles.quantityContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 15\n    }\n  }, React.createElement(Text, {\n    style: styles.quantity,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 17\n    }\n  }, order.baseProducts)), React.createElement(TouchableOpacity, {\n    style: styles.incDecButton,\n    onPress: function onPress() {\n      return addBaseProducts(delivery.baseProductsPrice);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 15\n    }\n  }, React.createElement(Entypo, {\n    name: \"plus\",\n    size: 24,\n    color: \"#8898AA\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 17\n    }\n  })))), React.createElement(ScrollView, {\n    style: styles.baseProductsItems,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.textItens,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 13\n    }\n  }, formatBaseProducts(delivery.baseProducts)))), React.createElement(Divider, {\n    style: {\n      borderBottomColor: Colors.secondary\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 9\n    }\n  }), React.createElement(View, {\n    style: styles.extraProductsContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: styles.title,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.textTitle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 13\n    }\n  }, \"Extras\")), React.createElement(ScrollView, {\n    style: styles.extraProducts,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 11\n    }\n  }, orderProducts.map(function (item, index) {\n    return React.createElement(View, {\n      key: index,\n      style: styles.extraProductItems,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 17\n      }\n    }, React.createElement(View, {\n      style: styles.line,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 19\n      }\n    }, React.createElement(View, {\n      style: styles.itemContainer,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 21\n      }\n    }, React.createElement(Text, {\n      style: styles.textItens,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 23\n      }\n    }, item.productTitle, \" (R$\", item.productPrice.toFixed(2), \")\"))), React.createElement(View, {\n      style: styles.controls,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 19\n      }\n    }, React.createElement(View, {\n      style: styles.incDecButton,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 21\n      }\n    }, React.createElement(TouchableOpacity, {\n      onPress: function onPress() {\n        return removeProduct(orderProducts, item);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 23\n      }\n    }, React.createElement(Entypo, {\n      name: \"minus\",\n      size: 24,\n      color: \"#8898AA\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 25\n      }\n    }))), React.createElement(Text, {\n      style: styles.quantity,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 21\n      }\n    }, item.quantity), React.createElement(View, {\n      style: styles.incDecButton,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 21\n      }\n    }, React.createElement(TouchableOpacity, {\n      onPress: function onPress() {\n        return addProduct(orderProducts, item, initialProducts);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 23\n      }\n    }, React.createElement(Entypo, {\n      name: \"plus\",\n      size: 24,\n      color: \"#8898AA\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 364,\n        columnNumber: 25\n      }\n    })))));\n  }))), React.createElement(View, {\n    style: styles.buttonContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 9\n    }\n  }, React.createElement(Divider, {\n    style: {\n      borderBottomColor: Colors.secondary\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 11\n    }\n  }), renderConfirmButton(), renderCompleteDeliveryButton())));\n};\n\nexport var consumerOrderScreenOptions = function consumerOrderScreenOptions(navData) {\n  var _navData$route$params = navData.route.params,\n      deliveryDate = _navData$route$params.deliveryDate,\n      user = _navData$route$params.user;\n\n  var _headerTitle = isConsumer(user) ? 'Fazer pedido' : \"Fazer pedido - \" + (user == null ? void 0 : user.name);\n\n  return {\n    headerTitle: function headerTitle() {\n      return React.createElement(View, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 7\n        }\n      }, React.createElement(View, {\n        style: styles.header,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 393,\n          columnNumber: 9\n        }\n      }, React.createElement(HeaderTitle, {\n        title: _headerTitle,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 11\n        }\n      }), React.createElement(View, {\n        style: styles.imageContainer,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 11\n        }\n      }, React.createElement(Image, {\n        style: styles.image,\n        source: VegetableImage,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 13\n        }\n      }))), React.createElement(Text, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 9\n        }\n      }, \"Entrega da cesta - \", deliveryDate));\n    },\n    headerBackImage: function headerBackImage() {\n      return React.createElement(BackArrow, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 28\n        }\n      });\n    },\n    headerStyle: {\n      backgroundColor: 'transparent',\n      elevation: 0,\n      shadowOpacity: 0,\n      borderBottomWidth: 0\n    }\n  };\n};\nvar styles = StyleSheet.create({\n  screen: {\n    flex: 1,\n    marginTop: 4,\n    backgroundColor: 'white',\n    borderTopLeftRadius: 20,\n    borderTopRightRadius: 20,\n    shadowColor: 'black',\n    shadowOpacity: 0.26,\n    shadowOffset: {\n      width: 4,\n      height: -3\n    },\n    shadowRadius: 8,\n    elevation: 25\n  },\n  container: {\n    flex: 1,\n    marginLeft: 25,\n    marginRight: 25,\n    marginTop: 10,\n    marginBottom: 10\n  },\n  baseProductsContainer: {\n    marginBottom: 10,\n    height: '20%'\n  },\n  baseProducts: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center'\n  },\n  baseProductsItems: {},\n  title: {\n    flex: 1,\n    justifyContent: 'center',\n    height: 40\n  },\n  textTitle: {\n    fontFamily: 'Roboto',\n    fontWeight: '700',\n    fontSize: 16,\n    color: '#505050'\n  },\n  controls: {\n    flexDirection: 'row'\n  },\n  incDecButton: {\n    width: 35,\n    height: 35,\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  textControls: {\n    fontFamily: 'Roboto',\n    fontSize: 25,\n    fontWeight: 'bold',\n    color: '#8898AA'\n  },\n  quantityContainer: {\n    justifyContent: 'center'\n  },\n  quantity: {\n    fontSize: 20,\n    paddingLeft: 5,\n    paddingRight: 5,\n    borderBottomWidth: 2,\n    borderBottomColor: '#8898AA',\n    color: '#8898AA'\n  },\n  extraProductsContainer: {\n    marginTop: 10,\n    marginBottom: 10,\n    height: '63%'\n  },\n  line: {\n    flex: 1,\n    flexDirection: 'row'\n  },\n  itemContainer: {\n    justifyContent: 'center'\n  },\n  extraProducts: {\n    marginTop: 10\n  },\n  extraProductItems: {\n    flex: 1,\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    paddingTop: 5\n  },\n  textItens: {\n    fontFamily: 'Roboto',\n    fontWeight: '400',\n    fontSize: 16,\n    color: '#505050'\n  },\n  buttonContainer: {\n    position: 'absolute',\n    width: '100%',\n    bottom: 0\n  },\n  confirmButton: {\n    marginTop: 5,\n    backgroundColor: Colors.primary,\n    justifyContent: 'space-between'\n  },\n  completeDeliveryButton: {\n    marginTop: 5,\n    backgroundColor: Colors.secondary,\n    justifyContent: 'space-between'\n  },\n  disabledButton: {\n    marginTop: 5,\n    backgroundColor: Colors.tertiary,\n    justifyContent: 'space-between'\n  },\n  header: {\n    alignItems: 'flex-start'\n  },\n  imageContainer: {\n    position: 'absolute',\n    right: -10,\n    width: 80,\n    height: 55\n  },\n  image: {\n    width: '100%',\n    height: '100%'\n  }\n});\nexport default ConsumerOrderScreen;","map":{"version":3,"sources":["/home/bordi/projects/cestas-cooperflora-rn/src/screens/consumer/ConsumerOrderScreen.js"],"names":["React","useContext","useEffect","useState","format","useFocusEffect","GLOBALS","Context","OrderContext","PaymentContext","UserContext","Colors","Divider","Button","HeaderTitle","BackArrow","VegetableImage","Spinner","isConsumer","showAlert","DeliveryContext","Entypo","ConsumerOrderScreen","route","navigation","params","user","delivery","orderProducts","setOrderProducts","state","loading","order","initialProducts","addBaseProducts","removeBaseProducts","addProduct","removeProduct","addOrder","fetchUserOrder","completeOrderDelivery","userLoading","findUserById","paymentLoading","createPaymentForUser","deliveryLoading","formatBaseProducts","baseProducts","toLowerCase","replace","resolveProductAvailableQuantity","product","initialQuantity","maxOrderQuantity","availableQuantity","orderedQuantity","Math","min","transformOrderProducts","deliveryExtraProducts","extraProducts","orderExtraProducts","forEach","orderProduct","deliveryProduct","initialIndex","findIndex","prod","productId","id","maxQuantity","length","quantity","filter","ids","map","includes","push","productPrice","price","productTitle","name","transformedOrderProducts","sort","a","b","useCallback","console","log","role","setParams","deliveryDate","FORMAT","DD_MM","onHandleNewOrUpdatedOrder","deliveryFee","then","productsPriceSum","navigate","USER","ROLE","CONSUMER","goBack","catch","error","renderConfirmButton","buttonDisabled","deliveryId","userId","status","ORDER","STATUS","CANCELED","styles","confirmButton","disabledButton","toFixed","completeDelivery","completedOrder","orderUser","renderCompleteDeliveryButton","today","Date","setHours","COMPLETED","completeDeliveryButton","isLoading","screen","container","baseProductsContainer","title","textTitle","baseProductsPrice","controls","incDecButton","quantityContainer","baseProductsItems","textItens","borderBottomColor","secondary","extraProductsContainer","item","index","extraProductItems","line","itemContainer","buttonContainer","consumerOrderScreenOptions","navData","headerTitle","header","imageContainer","image","headerBackImage","headerStyle","backgroundColor","elevation","shadowOpacity","borderBottomWidth","StyleSheet","create","flex","marginTop","borderTopLeftRadius","borderTopRightRadius","shadowColor","shadowOffset","width","height","shadowRadius","marginLeft","marginRight","marginBottom","flexDirection","justifyContent","alignItems","fontFamily","fontWeight","fontSize","color","textControls","paddingLeft","paddingRight","paddingTop","position","bottom","primary","tertiary","right"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,UAAhB,EAA4BC,SAA5B,EAAuCC,QAAvC,QAAuD,OAAvD;;;;;;;AASA,SAASC,MAAT,QAAuB,UAAvB;AACA,SAASC,cAAT,QAA+B,0BAA/B;AACA,OAAOC,OAAP;AACA,SAASC,OAAO,IAAIC,YAApB;AACA,SAASD,OAAO,IAAIE,cAApB;AACA,SAASF,OAAO,IAAIG,WAApB;AACA,OAAOC,MAAP;AACA,OAAOC,OAAP;AACA,OAAOC,MAAP;AACA,OAAOC,WAAP;AACA,OAAOC,SAAP;AACA,OAAOC,cAAP;AACA,OAAOC,OAAP;AACA,SAASC,UAAT,EAAqBC,SAArB;AACA,SAASZ,OAAO,IAAIa,eAApB;AACA,SAASC,MAAT,QAAuB,oBAAvB;;AAEA,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB,OAA2B;AAAA;;AAAA,MAAxBC,KAAwB,QAAxBA,KAAwB;AAAA,MAAjBC,UAAiB,QAAjBA,UAAiB;AACrD,sBAA2BD,KAAK,CAACE,MAAjC;AAAA,MAAQC,IAAR,iBAAQA,IAAR;AAAA,MAAcC,QAAd,iBAAcA,QAAd;;AAEA,kBAA0CxB,QAAQ,CAAC,EAAD,CAAlD;AAAA;AAAA,MAAOyB,aAAP;AAAA,MAAsBC,gBAAtB;;AAEA,oBASI5B,UAAU,CAACO,YAAD,CATd;AAAA,sCACEsB,KADF;AAAA,MACWC,OADX,qBACWA,OADX;AAAA,MACoBC,KADpB,qBACoBA,KADpB;AAAA,MAC2BC,eAD3B,qBAC2BA,eAD3B;AAAA,MAEEC,eAFF,eAEEA,eAFF;AAAA,MAGEC,kBAHF,eAGEA,kBAHF;AAAA,MAIEC,UAJF,eAIEA,UAJF;AAAA,MAKEC,aALF,eAKEA,aALF;AAAA,MAMEC,QANF,eAMEA,QANF;AAAA,MAOEC,cAPF,eAOEA,cAPF;AAAA,MAQEC,qBARF,eAQEA,qBARF;;AAWA,qBAGIvC,UAAU,CAACS,WAAD,CAHd;AAAA,MACoB+B,WADpB,gBACEX,KADF,CACWC,OADX;AAAA,MAEEW,YAFF,gBAEEA,YAFF;;AAKA,qBAGIzC,UAAU,CAACQ,cAAD,CAHd;AAAA,MACoBkC,cADpB,gBACEb,KADF,CACWC,OADX;AAAA,MAEEa,oBAFF,gBAEEA,oBAFF;;AAKA,qBAEI3C,UAAU,CAACmB,eAAD,CAFd;AAAA,MACoByB,eADpB,gBACEf,KADF,CACWC,OADX;;AAIA,MAAMe,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,YAAD,EAAkB;AAC3C,WAAOA,YAAY,CAACC,WAAb,GAA2BC,OAA3B,CAAmC,KAAnC,EAA0C,IAA1C,CAAP;AACD,GAFD;;AAIA,MAAMC,+BAA+B,GAAG,SAAlCA,+BAAkC,CAACC,OAAD,EAAUC,eAAV,EAA8B;AACpEA,IAAAA,eAAe,GAAGA,eAAe,IAAI,IAAnB,GAA0BA,eAA1B,GAA4C,CAA9D;;AAEA,QAAID,OAAO,CAACE,gBAAR,IAA4B,IAA5B,IAAoCF,OAAO,CAACG,iBAAR,IAA6B,IAArE,EAA2E;AACzE,UAAMA,iBAAiB,GACrBH,OAAO,CAACG,iBAAR,GAA4BH,OAAO,CAACI,eADtC;AAEA,aAAOC,IAAI,CAACC,GAAL,CACLN,OAAO,CAACE,gBADH,EAELC,iBAAiB,GAAGF,eAFf,CAAP;AAID;;AAED,QAAID,OAAO,CAACE,gBAAR,IAA4B,IAA5B,IAAoCF,OAAO,CAACG,iBAAR,IAA6B,IAArE,EAA2E;AACzE,aAAOH,OAAO,CAACE,gBAAf;AACD;;AAED,QAAIF,OAAO,CAACG,iBAAR,IAA6B,IAAjC,EAAuC;AACrC,aACEH,OAAO,CAACG,iBAAR,GAA4BH,OAAO,CAACI,eAApC,GAAsDH,eADxD;AAGD;;AAED,WAAO,IAAP;AACD,GAvBD;;AAyBA,MAAMM,sBAAsB,GAAG,SAAzBA,sBAAyB,GAAM;AACnC,QAAMC,qBAAqB,GAAGhC,QAAQ,CAACiC,aAAvC;AACA,QAAMC,kBAAkB,GAAG7B,KAAK,CAAC4B,aAAN,GAAsB5B,KAAK,CAAC4B,aAA5B,GAA4C,EAAvE;AAEAC,IAAAA,kBAAkB,CAACC,OAAnB,CAA2B,UAACC,YAAD,EAAkB;AAC3CJ,MAAAA,qBAAqB,CAACG,OAAtB,CAA8B,UAACE,eAAD,EAAqB;AACjD,YAAMC,YAAY,GAAGhC,eAAe,CAACiC,SAAhB,CACnB,UAACC,IAAD;AAAA,iBAAUA,IAAI,CAACC,SAAL,KAAmBL,YAAY,CAACK,SAA1C;AAAA,SADmB,CAArB;;AAIA,YAAIL,YAAY,CAACK,SAAb,KAA2BJ,eAAe,CAACK,EAA/C,EAAmD;AACjDN,UAAAA,YAAY,CAACO,WAAb,GACErC,eAAe,CAACsC,MAAhB,GAAyB,CAAzB,IAA8BtC,eAAe,CAACgC,YAAD,CAAf,IAAiC,IAA/D,GACIf,+BAA+B,CAC/Bc,eAD+B,EAE/B/B,eAAe,CAACgC,YAAD,CAAf,CAA8BO,QAFC,CADnC,GAKItB,+BAA+B,CAACc,eAAD,EAAkB,CAAlB,CANrC;AAOD;AACF,OAdD;AAeD,KAhBD;AAkBAL,IAAAA,qBAAqB,CAClBc,MADH,CACU,UAACT,eAAD,EAAqB;AAC3B,UAAMU,GAAG,GAAGb,kBAAkB,CAACc,GAAnB,CACV,UAACZ,YAAD;AAAA,eAAkBA,YAAY,CAACK,SAA/B;AAAA,OADU,CAAZ;AAGA,aAAO,CAACM,GAAG,CAACE,QAAJ,CAAaZ,eAAe,CAACK,EAA7B,CAAR;AACD,KANH,EAOGP,OAPH,CAOW,UAACX,OAAD,EAAa;AACpBU,MAAAA,kBAAkB,CAACgB,IAAnB,CAAwB;AACtBT,QAAAA,SAAS,EAAEjB,OAAO,CAACkB,EADG;AAEtBS,QAAAA,YAAY,EAAE3B,OAAO,CAAC4B,KAFA;AAGtBC,QAAAA,YAAY,EAAE7B,OAAO,CAAC8B,IAHA;AAItBT,QAAAA,QAAQ,EAAE,CAJY;AAKtBF,QAAAA,WAAW,EAAEpB,+BAA+B,CAACC,OAAD;AALtB,OAAxB;AAOD,KAfH;AAiBA,QAAM+B,wBAAwB,GAAGrB,kBAAjC;AACAqB,IAAAA,wBAAwB,CAACC,IAAzB,CAA8B,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACtC,aAAOD,CAAC,CAACJ,YAAF,GAAiBK,CAAC,CAACL,YAAnB,GAAkC,CAAlC,GAAsC,CAAC,CAA9C;AACD,KAFD;AAIAnD,IAAAA,gBAAgB,CAACqD,wBAAD,CAAhB;AACD,GA7CD;;AA+CA7E,EAAAA,cAAc,CACZL,KAAK,CAACsF,WAAN,CAAkB,YAAM;AACtBC,IAAAA,OAAO,CAACC,GAAR,CAAY,yDAAZ;;AACA,QAAI9D,IAAI,IAAIC,QAAZ,EAAsB;AACpB,UAAI,CAACD,IAAI,CAAC+D,IAAN,IAAczD,KAAK,IAAI,IAA3B,EAAiC;AAC/BuD,QAAAA,OAAO,CAACC,GAAR;AAEAjD,QAAAA,cAAc,CAACb,IAAI,CAAC2C,EAAN,EAAU1C,QAAQ,CAAC0C,EAAnB,EAAuB1C,QAAQ,CAACiC,aAAhC,CAAd;AACD;;AAGDpC,MAAAA,UAAU,CAACkE,SAAX,CAAqB;AACnBC,QAAAA,YAAY,EAAEvF,MAAM,CAACuB,QAAQ,CAACgE,YAAV,EAAwBrF,OAAO,CAACsF,MAAR,CAAeC,KAAvC;AADD,OAArB;AAGD;AACF,GAdD,EAcG,CAACnE,IAAD,EAAOC,QAAP,CAdH,CADY,CAAd;AAkBAzB,EAAAA,SAAS,CAAC,YAAM;AACdwD,IAAAA,sBAAsB;AACvB,GAFQ,EAEN,CAAC1B,KAAD,EAAQL,QAAR,CAFM,CAAT;;AAIA,MAAMmE,yBAAyB,GAAG,SAA5BA,yBAA4B,GAAM;AACtCP,IAAAA,OAAO,CAACC,GAAR,CAAY,oDAAZ;AAEAlD,IAAAA,QAAQ,CACNZ,IAAI,CAAC2C,EADC,EAEN3C,IAAI,CAACuD,IAFC,EAGNtD,QAAQ,CAAC0C,EAHH,EAIN1C,QAAQ,CAACoE,WAJH,EAKN/D,KALM,EAMNC,eANM,CAAR,CAQG+D,IARH,CAQQ,YAAM;AACV,UAAIhE,KAAK,CAACiE,gBAAN,KAA2B,CAA/B,EAAkC;AAChC9E,QAAAA,SAAS,CAAC,6CAAD,CAAT;AACAK,QAAAA,UAAU,CAAC0E,QAAX,CAAoB,kBAApB;AACA;AACD;;AAED,UAAIxE,IAAI,CAAC+D,IAAL,IAAa/D,IAAI,CAAC+D,IAAL,KAAcnF,OAAO,CAAC6F,IAAR,CAAaC,IAAb,CAAkBC,QAAjD,EAA2D;AACzD7E,QAAAA,UAAU,CAAC0E,QAAX,CAAoB,2BAApB,EAAiD;AAC/CvE,UAAAA,QAAQ,EAARA,QAD+C;AAE/CD,UAAAA,IAAI,EAAJA;AAF+C,SAAjD;AAID,OALD,MAKO;AACLF,QAAAA,UAAU,CAAC8E,MAAX;AACD;AACF,KAvBH,EAwBGC,KAxBH,CAwBS,UAACC,KAAD,EAAW;AAChBrF,MAAAA,SAAS,CAACqF,KAAD,CAAT;AACAjE,MAAAA,cAAc,CAACb,IAAI,CAAC2C,EAAN,EAAU1C,QAAQ,CAAC0C,EAAnB,EAAuB1C,QAAQ,CAACiC,aAAhC,CAAd;AACD,KA3BH;AA4BD,GA/BD;;AAiCA,MAAM6C,mBAAmB,GAAG,SAAtBA,mBAAsB,GAAM;AAAA;;AAChC,QAAMC,cAAc,GAAG,KAAvB;;AACA,QAAI1E,KAAK,CAACiE,gBAAN,KAA2B,CAA/B,EAAkC;AAAA;;AAChC,UACEjE,KAAK,CAAC2E,UAAN,IACA3E,KAAK,CAAC4E,MADN,IAEA5E,KAAK,CAAC6E,MAAN,KAAiBvG,OAAO,CAACwG,KAAR,CAAcC,MAAd,CAAqBC,QAHxC,EAIE;AACA,eACE,oBAAC,MAAD;AACE,UAAA,EAAE,EAAC,oBADL;AAEE,UAAA,KAAK,EAAEC,MAAM,CAACC,aAFhB;AAGE,UAAA,SAAS,EAAC,OAHZ;AAIE,UAAA,OAAO,EAAEpB,yBAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BADF;AAUD;;AACD,aACE,oBAAC,MAAD;AACE,QAAA,EAAE,EAAC,oBADL;AAEE,QAAA,KAAK,EAAEmB,MAAM,CAACE,cAFhB;AAGE,QAAA,SAAS,EAAC,OAHZ;AAIE,QAAA,OAAO,EAAErB,yBAJX;AAKE,QAAA,QAAQ,MALV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mDAOgB9D,KAAK,CAACiE,gBAPtB,qBAOgB,sBAAwBmB,OAAxB,CAAgC,CAAhC,CAPhB,CADF;AAWD;;AAED,WACE,oBAAC,MAAD;AACE,MAAA,EAAE,EAAC,oBADL;AAEE,MAAA,KAAK,EAAEH,MAAM,CAACC,aAFhB;AAGE,MAAA,SAAS,EAAC,OAHZ;AAIE,MAAA,OAAO,EAAEpB,yBAJX;AAKE,MAAA,QAAQ,EAAEY,cALZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kDAOgB1E,KAAK,CAACiE,gBAPtB,qBAOgB,uBAAwBmB,OAAxB,CAAgC,CAAhC,CAPhB,CADF;AAWD,GA3CD;;AA6CA,MAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACnBrF,KAAK,CAACqC,EAAN,IAAYrC,KAAK,CAAC2E,UAAlB,IAAgC3E,KAAK,CAAC4E,MADnB;AAAA;AAAA;AAAA;;AAAA;AAAA,6CAEQpE,qBAAqB,CAChDd,IAAI,CAAC2C,EAD2C,EAEhD3C,IAAI,CAACuD,IAF2C,EAGhDtD,QAAQ,CAAC0C,EAHuC,EAIhD1C,QAAQ,CAACoE,WAJuC,EAKhD/D,KALgD,CAF7B;;AAAA;AAEfsF,YAAAA,cAFe;AAAA;AAAA,6CASG5E,YAAY,CAACV,KAAK,CAAC4E,MAAP,CATf;;AAAA;AASfW,YAAAA,SATe;AAAA;AAAA,6CAUf3E,oBAAoB,CAAC2E,SAAD,EAAYD,cAAZ,CAVL;;AAAA;AAWrB9F,YAAAA,UAAU,CAAC8E,MAAX,CAAkB,IAAlB;;AAXqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAzB;;AAeA,MAAMkB,4BAA4B,GAAG,SAA/BA,4BAA+B,GAAM;AAAA;;AACzC,QAAMC,KAAK,GAAG,IAAIC,IAAJ,EAAd;AACAD,IAAAA,KAAK,CAACE,QAAN,CAAe,CAAf,EAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB;AACA,6BAAAhG,QAAQ,CAACgE,YAAT,2CAAuBgC,QAAvB,CAAgC,CAAhC,EAAmC,CAAnC,EAAsC,CAAtC,EAAyC,CAAzC;;AAEA,QACE3F,KAAK,CAAC6E,MAAN,IAAgB,IAAhB,IACA7E,KAAK,CAAC6E,MAAN,KAAiBvG,OAAO,CAACwG,KAAR,CAAcC,MAAd,CAAqBa,SAFxC,EAGE;AACA,aACE,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAEX,MAAM,CAACE,cAAtB;AAAsC,QAAA,SAAS,EAAC,OAAhD;AAAwD,QAAA,QAAQ,MAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCADF;AAKD;;AAED,QACEM,KAAK,IAAI9F,QAAQ,CAACgE,YAAlB,IACA,CAACjE,IAAI,CAAC+D,IADN,IAEAzD,KAAK,CAACiE,gBAAN,GAAyB,CAFzB,IAGAjE,KAAK,CAACqC,EAJR,EAKE;AACA,aACE,oBAAC,MAAD;AACE,QAAA,KAAK,EAAE4C,MAAM,CAACY,sBADhB;AAEE,QAAA,SAAS,EAAC,OAFZ;AAGE,QAAA,OAAO,EAAE;AAAA,iBAAMR,gBAAgB,EAAtB;AAAA,SAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADF;AASD;;AAED,WAAO,IAAP;AACD,GAlCD;;AAoCA,MAAMS,SAAS,GAAG,SAAZA,SAAY,GAAM;AACtB,WACE,CAAC9F,KAAD,IACA,CAACL,QADD,IAEAI,OAFA,IAGAc,eAHA,IAIAJ,WAJA,IAKAE,cANF;AAQD,GATD;;AAWA,SAAOmF,SAAS,KACd,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADc,GAGd,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEb,MAAM,CAACc,MAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEd,MAAM,CAACe,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEf,MAAM,CAACgB,qBAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEhB,MAAM,CAAClE,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEkE,MAAM,CAACiB,KAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AACE,IAAA,KAAK,EAAEjB,MAAM,CAACkB,SADhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CAEYxG,QAAQ,CAACyG,iBAFrB,qBAEY,sBAA4BhB,OAA5B,CAAoC,CAApC,CAFZ,QADF,CADF,EAME,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEH,MAAM,CAACoB,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,gBAAD;AACE,IAAA,KAAK,EAAEpB,MAAM,CAACqB,YADhB;AAEE,IAAA,OAAO,EAAE;AAAA,aAAMnG,kBAAkB,CAACR,QAAQ,CAACyG,iBAAV,CAAxB;AAAA,KAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAKE,oBAAC,MAAD;AAAQ,IAAA,IAAI,EAAC,OAAb;AAAqB,IAAA,IAAI,EAAE,EAA3B;AAA+B,IAAA,KAAK,EAAC,SAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALF,CADF,EAQE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEnB,MAAM,CAACsB,iBAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEtB,MAAM,CAACzC,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA+BxC,KAAK,CAACe,YAArC,CADF,CARF,EAWE,oBAAC,gBAAD;AACE,IAAA,KAAK,EAAEkE,MAAM,CAACqB,YADhB;AAEE,IAAA,OAAO,EAAE;AAAA,aAAMpG,eAAe,CAACP,QAAQ,CAACyG,iBAAV,CAArB;AAAA,KAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAKE,oBAAC,MAAD;AAAQ,IAAA,IAAI,EAAC,MAAb;AAAoB,IAAA,IAAI,EAAE,EAA1B;AAA8B,IAAA,KAAK,EAAC,SAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALF,CAXF,CANF,CADF,EA2BE,oBAAC,UAAD;AAAY,IAAA,KAAK,EAAEnB,MAAM,CAACuB,iBAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEvB,MAAM,CAACwB,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG3F,kBAAkB,CAACnB,QAAQ,CAACoB,YAAV,CADrB,CADF,CA3BF,CADF,EAkCE,oBAAC,OAAD;AAAS,IAAA,KAAK,EAAE;AAAE2F,MAAAA,iBAAiB,EAAE/H,MAAM,CAACgI;AAA5B,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAlCF,EAmCE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE1B,MAAM,CAAC2B,sBAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE3B,MAAM,CAACiB,KAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEjB,MAAM,CAACkB,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,CADF,EAIE,oBAAC,UAAD;AAAY,IAAA,KAAK,EAAElB,MAAM,CAACrD,aAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGhC,aAAa,CAAC+C,GAAd,CAAkB,UAACkE,IAAD,EAAOC,KAAP,EAAiB;AAClC,WACE,oBAAC,IAAD;AAAM,MAAA,GAAG,EAAEA,KAAX;AAAkB,MAAA,KAAK,EAAE7B,MAAM,CAAC8B,iBAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAE9B,MAAM,CAAC+B,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAE/B,MAAM,CAACgC,aAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAEhC,MAAM,CAACwB,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGI,IAAI,CAAC7D,YADR,UAC0B6D,IAAI,CAAC/D,YAAL,CAAkBsC,OAAlB,CAA0B,CAA1B,CAD1B,MADF,CADF,CADF,EAQE,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAEH,MAAM,CAACoB,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAEpB,MAAM,CAACqB,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,gBAAD;AACE,MAAA,OAAO,EAAE;AAAA,eAAMjG,aAAa,CAACT,aAAD,EAAgBiH,IAAhB,CAAnB;AAAA,OADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAGE,oBAAC,MAAD;AAAQ,MAAA,IAAI,EAAC,OAAb;AAAqB,MAAA,IAAI,EAAE,EAA3B;AAA+B,MAAA,KAAK,EAAC,SAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAHF,CADF,CADF,EAQE,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAE5B,MAAM,CAACzC,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA+BqE,IAAI,CAACrE,QAApC,CARF,EASE,oBAAC,IAAD;AAAM,MAAA,KAAK,EAAEyC,MAAM,CAACqB,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,oBAAC,gBAAD;AACE,MAAA,OAAO,EAAE;AAAA,eACPlG,UAAU,CAACR,aAAD,EAAgBiH,IAAhB,EAAsB5G,eAAtB,CADH;AAAA,OADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAKE,oBAAC,MAAD;AAAQ,MAAA,IAAI,EAAC,MAAb;AAAoB,MAAA,IAAI,EAAE,EAA1B;AAA8B,MAAA,KAAK,EAAC,SAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MALF,CADF,CATF,CARF,CADF;AA8BD,GA/BA,CADH,CAJF,CAnCF,EA0EE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAEgF,MAAM,CAACiC,eAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,OAAD;AAAS,IAAA,KAAK,EAAE;AAAER,MAAAA,iBAAiB,EAAE/H,MAAM,CAACgI;AAA5B,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEGlC,mBAAmB,EAFtB,EAGGe,4BAA4B,EAH/B,CA1EF,CADF,CAHF;AAsFD,CAlWD;;AAoWA,OAAO,IAAM2B,0BAA0B,GAAG,SAA7BA,0BAA6B,CAACC,OAAD,EAAa;AACrD,8BAA+BA,OAAO,CAAC7H,KAAR,CAAcE,MAA7C;AAAA,MAAQkE,YAAR,yBAAQA,YAAR;AAAA,MAAsBjE,IAAtB,yBAAsBA,IAAtB;;AACA,MAAM2H,YAAW,GAAGnI,UAAU,CAACQ,IAAD,CAAV,GAChB,cADgB,wBAEEA,IAFF,oBAEEA,IAAI,CAAEuD,IAFR,CAApB;;AAKA,SAAO;AACLoE,IAAAA,WAAW,EAAE;AAAA,aACX,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAEpC,MAAM,CAACqC,MAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,WAAD;AAAa,QAAA,KAAK,EAAED,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAEpC,MAAM,CAACsC,cAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,KAAD;AAAO,QAAA,KAAK,EAAEtC,MAAM,CAACuC,KAArB;AAA4B,QAAA,MAAM,EAAExI,cAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CAFF,CADF,EAOE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCAA0B2E,YAA1B,CAPF,CADW;AAAA,KADR;AAYL8D,IAAAA,eAAe,EAAE;AAAA,aAAM,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAN;AAAA,KAZZ;AAaLC,IAAAA,WAAW,EAAE;AACXC,MAAAA,eAAe,EAAE,aADN;AAEXC,MAAAA,SAAS,EAAE,CAFA;AAGXC,MAAAA,aAAa,EAAE,CAHJ;AAIXC,MAAAA,iBAAiB,EAAE;AAJR;AAbR,GAAP;AAoBD,CA3BM;AA6BP,IAAM7C,MAAM,GAAG8C,UAAU,CAACC,MAAX,CAAkB;AAC/BjC,EAAAA,MAAM,EAAE;AACNkC,IAAAA,IAAI,EAAE,CADA;AAENC,IAAAA,SAAS,EAAE,CAFL;AAGNP,IAAAA,eAAe,EAAE,OAHX;AAINQ,IAAAA,mBAAmB,EAAE,EAJf;AAKNC,IAAAA,oBAAoB,EAAE,EALhB;AAMNC,IAAAA,WAAW,EAAE,OANP;AAONR,IAAAA,aAAa,EAAE,IAPT;AAQNS,IAAAA,YAAY,EAAE;AAAEC,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,MAAM,EAAE,CAAC;AAArB,KARR;AASNC,IAAAA,YAAY,EAAE,CATR;AAUNb,IAAAA,SAAS,EAAE;AAVL,GADuB;AAa/B5B,EAAAA,SAAS,EAAE;AACTiC,IAAAA,IAAI,EAAE,CADG;AAETS,IAAAA,UAAU,EAAE,EAFH;AAGTC,IAAAA,WAAW,EAAE,EAHJ;AAITT,IAAAA,SAAS,EAAE,EAJF;AAKTU,IAAAA,YAAY,EAAE;AALL,GAboB;AAoB/B3C,EAAAA,qBAAqB,EAAE;AACrB2C,IAAAA,YAAY,EAAE,EADO;AAErBJ,IAAAA,MAAM,EAAE;AAFa,GApBQ;AAwB/BzH,EAAAA,YAAY,EAAE;AACZ8H,IAAAA,aAAa,EAAE,KADH;AAEZC,IAAAA,cAAc,EAAE,eAFJ;AAGZC,IAAAA,UAAU,EAAE;AAHA,GAxBiB;AA6B/BvC,EAAAA,iBAAiB,EAAE,EA7BY;AAiC/BN,EAAAA,KAAK,EAAE;AACL+B,IAAAA,IAAI,EAAE,CADD;AAELa,IAAAA,cAAc,EAAE,QAFX;AAGLN,IAAAA,MAAM,EAAE;AAHH,GAjCwB;AAsC/BrC,EAAAA,SAAS,EAAE;AACT6C,IAAAA,UAAU,EAAE,QADH;AAETC,IAAAA,UAAU,EAAE,KAFH;AAGTC,IAAAA,QAAQ,EAAE,EAHD;AAITC,IAAAA,KAAK,EAAE;AAJE,GAtCoB;AA4C/B9C,EAAAA,QAAQ,EAAE;AACRwC,IAAAA,aAAa,EAAE;AADP,GA5CqB;AA+C/BvC,EAAAA,YAAY,EAAE;AACZiC,IAAAA,KAAK,EAAE,EADK;AAEZC,IAAAA,MAAM,EAAE,EAFI;AAGZO,IAAAA,UAAU,EAAE,QAHA;AAIZD,IAAAA,cAAc,EAAE;AAJJ,GA/CiB;AAqD/BM,EAAAA,YAAY,EAAE;AACZJ,IAAAA,UAAU,EAAE,QADA;AAEZE,IAAAA,QAAQ,EAAE,EAFE;AAGZD,IAAAA,UAAU,EAAE,MAHA;AAIZE,IAAAA,KAAK,EAAE;AAJK,GArDiB;AA2D/B5C,EAAAA,iBAAiB,EAAE;AACjBuC,IAAAA,cAAc,EAAE;AADC,GA3DY;AA8D/BtG,EAAAA,QAAQ,EAAE;AACR0G,IAAAA,QAAQ,EAAE,EADF;AAERG,IAAAA,WAAW,EAAE,CAFL;AAGRC,IAAAA,YAAY,EAAE,CAHN;AAIRxB,IAAAA,iBAAiB,EAAE,CAJX;AAKRpB,IAAAA,iBAAiB,EAAE,SALX;AAMRyC,IAAAA,KAAK,EAAE;AANC,GA9DqB;AAsE/BvC,EAAAA,sBAAsB,EAAE;AACtBsB,IAAAA,SAAS,EAAE,EADW;AAEtBU,IAAAA,YAAY,EAAE,EAFQ;AAGtBJ,IAAAA,MAAM,EAAE;AAHc,GAtEO;AA2E/BxB,EAAAA,IAAI,EAAE;AACJiB,IAAAA,IAAI,EAAE,CADF;AAEJY,IAAAA,aAAa,EAAE;AAFX,GA3EyB;AA+E/B5B,EAAAA,aAAa,EAAE;AACb6B,IAAAA,cAAc,EAAE;AADH,GA/EgB;AAkF/BlH,EAAAA,aAAa,EAAE;AACbsG,IAAAA,SAAS,EAAE;AADE,GAlFgB;AAqF/BnB,EAAAA,iBAAiB,EAAE;AACjBkB,IAAAA,IAAI,EAAE,CADW;AAEjBY,IAAAA,aAAa,EAAE,KAFE;AAGjBC,IAAAA,cAAc,EAAE,eAHC;AAIjBS,IAAAA,UAAU,EAAE;AAJK,GArFY;AA2F/B9C,EAAAA,SAAS,EAAE;AACTuC,IAAAA,UAAU,EAAE,QADH;AAETC,IAAAA,UAAU,EAAE,KAFH;AAGTC,IAAAA,QAAQ,EAAE,EAHD;AAITC,IAAAA,KAAK,EAAE;AAJE,GA3FoB;AAiG/BjC,EAAAA,eAAe,EAAE;AACfsC,IAAAA,QAAQ,EAAE,UADK;AAEfjB,IAAAA,KAAK,EAAE,MAFQ;AAGfkB,IAAAA,MAAM,EAAE;AAHO,GAjGc;AAsG/BvE,EAAAA,aAAa,EAAE;AACbgD,IAAAA,SAAS,EAAE,CADE;AAEbP,IAAAA,eAAe,EAAEhJ,MAAM,CAAC+K,OAFX;AAGbZ,IAAAA,cAAc,EAAE;AAHH,GAtGgB;AA2G/BjD,EAAAA,sBAAsB,EAAE;AACtBqC,IAAAA,SAAS,EAAE,CADW;AAEtBP,IAAAA,eAAe,EAAEhJ,MAAM,CAACgI,SAFF;AAGtBmC,IAAAA,cAAc,EAAE;AAHM,GA3GO;AAgH/B3D,EAAAA,cAAc,EAAE;AACd+C,IAAAA,SAAS,EAAE,CADG;AAEdP,IAAAA,eAAe,EAAEhJ,MAAM,CAACgL,QAFV;AAGdb,IAAAA,cAAc,EAAE;AAHF,GAhHe;AAqH/BxB,EAAAA,MAAM,EAAE;AACNyB,IAAAA,UAAU,EAAE;AADN,GArHuB;AAwH/BxB,EAAAA,cAAc,EAAE;AACdiC,IAAAA,QAAQ,EAAE,UADI;AAEdI,IAAAA,KAAK,EAAE,CAAC,EAFM;AAGdrB,IAAAA,KAAK,EAAE,EAHO;AAIdC,IAAAA,MAAM,EAAE;AAJM,GAxHe;AA8H/BhB,EAAAA,KAAK,EAAE;AACLe,IAAAA,KAAK,EAAE,MADF;AAELC,IAAAA,MAAM,EAAE;AAFH;AA9HwB,CAAlB,CAAf;AAoIA,eAAelJ,mBAAf","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport {\n  Image,\n  ScrollView,\n  StyleSheet,\n  Text,\n  TouchableOpacity,\n  View,\n} from 'react-native';\nimport { format } from 'date-fns';\nimport { useFocusEffect } from '@react-navigation/native';\nimport GLOBALS from '../../Globals';\nimport { Context as OrderContext } from '../../context/OrderContext';\nimport { Context as PaymentContext } from '../../context/PaymentContext';\nimport { Context as UserContext } from '../../context/UserContext';\nimport Colors from '../../constants/Colors';\nimport Divider from '../../components/Divider';\nimport Button from '../../components/Button';\nimport HeaderTitle from '../../components/HeaderTitle';\nimport BackArrow from '../../components/BackArrow';\nimport VegetableImage from '../../../assets/images/vegetable2.png';\nimport Spinner from '../../components/Spinner';\nimport { isConsumer, showAlert } from '../../helper/HelperFunctions';\nimport { Context as DeliveryContext } from '../../context/DeliveryContext';\nimport { Entypo } from '@expo/vector-icons';\n\nconst ConsumerOrderScreen = ({ route, navigation }) => {\n  const { user, delivery } = route.params;\n  // const [baseProducts, setBaseProducts] = useState();\n  const [orderProducts, setOrderProducts] = useState([]);\n\n  const {\n    state: { loading, order, initialProducts },\n    addBaseProducts,\n    removeBaseProducts,\n    addProduct,\n    removeProduct,\n    addOrder,\n    fetchUserOrder,\n    completeOrderDelivery,\n  } = useContext(OrderContext);\n\n  const {\n    state: { loading: userLoading },\n    findUserById,\n  } = useContext(UserContext);\n\n  const {\n    state: { loading: paymentLoading },\n    createPaymentForUser,\n  } = useContext(PaymentContext);\n\n  const {\n    state: { loading: deliveryLoading },\n  } = useContext(DeliveryContext);\n\n  const formatBaseProducts = (baseProducts) => {\n    return baseProducts.toLowerCase().replace(/\\n/g, ', ');\n  };\n\n  const resolveProductAvailableQuantity = (product, initialQuantity) => {\n    initialQuantity = initialQuantity != null ? initialQuantity : 0;\n\n    if (product.maxOrderQuantity != null && product.availableQuantity != null) {\n      const availableQuantity =\n        product.availableQuantity - product.orderedQuantity;\n      return Math.min(\n        product.maxOrderQuantity,\n        availableQuantity + initialQuantity\n      );\n    }\n\n    if (product.maxOrderQuantity != null && product.availableQuantity == null) {\n      return product.maxOrderQuantity;\n    }\n\n    if (product.availableQuantity != null) {\n      return (\n        product.availableQuantity - product.orderedQuantity + initialQuantity\n      );\n    }\n\n    return null;\n  };\n\n  const transformOrderProducts = () => {\n    const deliveryExtraProducts = delivery.extraProducts;\n    const orderExtraProducts = order.extraProducts ? order.extraProducts : [];\n\n    orderExtraProducts.forEach((orderProduct) => {\n      deliveryExtraProducts.forEach((deliveryProduct) => {\n        const initialIndex = initialProducts.findIndex(\n          (prod) => prod.productId === orderProduct.productId\n        );\n\n        if (orderProduct.productId === deliveryProduct.id) {\n          orderProduct.maxQuantity =\n            initialProducts.length > 0 && initialProducts[initialIndex] != null\n              ? resolveProductAvailableQuantity(\n                deliveryProduct,\n                initialProducts[initialIndex].quantity\n              )\n              : resolveProductAvailableQuantity(deliveryProduct, 0);\n        }\n      });\n    });\n\n    deliveryExtraProducts\n      .filter((deliveryProduct) => {\n        const ids = orderExtraProducts.map(\n          (orderProduct) => orderProduct.productId\n        );\n        return !ids.includes(deliveryProduct.id);\n      })\n      .forEach((product) => {\n        orderExtraProducts.push({\n          productId: product.id,\n          productPrice: product.price,\n          productTitle: product.name,\n          quantity: 0,\n          maxQuantity: resolveProductAvailableQuantity(product),\n        });\n      });\n\n    const transformedOrderProducts = orderExtraProducts;\n    transformedOrderProducts.sort((a, b) => {\n      return a.productTitle > b.productTitle ? 1 : -1;\n    });\n\n    setOrderProducts(transformedOrderProducts);\n  };\n\n  useFocusEffect(\n    React.useCallback(() => {\n      console.log('[Consumer Order Product Screen - useEffect fetch orders');\n      if (user && delivery) {\n        if (!user.role || order == null) {\n          console.log(`[Consumer Order Screen] Fetching order...`);\n          // Quando não tem role, é porque está vindo da tela de gerenciamento, então é uma pessoa organizadora que está manipulando o pedido\n          fetchUserOrder(user.id, delivery.id, delivery.extraProducts);\n        }\n\n        // setBaseProducts(delivery.baseProducts);\n        navigation.setParams({\n          deliveryDate: format(delivery.deliveryDate, GLOBALS.FORMAT.DD_MM),\n        });\n      }\n    }, [user, delivery])\n  );\n\n  useEffect(() => {\n    transformOrderProducts();\n  }, [order, delivery]);\n\n  const onHandleNewOrUpdatedOrder = () => {\n    console.log('[Consumer Order Screen] Handle new or update order');\n\n    addOrder(\n      user.id,\n      user.name,\n      delivery.id,\n      delivery.deliveryFee,\n      order,\n      initialProducts\n    )\n      .then(() => {\n        if (order.productsPriceSum === 0) {\n          showAlert('Seu pedido para esta entrega foi cancelado.');\n          navigation.navigate('DeliveriesScreen');\n          return;\n        }\n\n        if (user.role && user.role === GLOBALS.USER.ROLE.CONSUMER) {\n          navigation.navigate('ConsumerOrderPlacedScreen', {\n            delivery,\n            user,\n          });\n        } else {\n          navigation.goBack();\n        }\n      })\n      .catch((error) => {\n        showAlert(error);\n        fetchUserOrder(user.id, delivery.id, delivery.extraProducts);\n      });\n  };\n\n  const renderConfirmButton = () => {\n    const buttonDisabled = false;\n    if (order.productsPriceSum === 0) {\n      if (\n        order.deliveryId &&\n        order.userId &&\n        order.status !== GLOBALS.ORDER.STATUS.CANCELED\n      ) {\n        return (\n          <Button\n            id=\"confirmOrderButton\"\n            style={styles.confirmButton}\n            textColor=\"white\"\n            onPress={onHandleNewOrUpdatedOrder}\n          >\n            Cancelar pedido\n          </Button>\n        );\n      }\n      return (\n        <Button\n          id=\"confirmOrderButton\"\n          style={styles.disabledButton}\n          textColor=\"white\"\n          onPress={onHandleNewOrUpdatedOrder}\n          disabled\n        >\n          Confirmar R$ {order.productsPriceSum?.toFixed(2)}\n        </Button>\n      );\n    }\n\n    return (\n      <Button\n        id=\"confirmOrderButton\"\n        style={styles.confirmButton}\n        textColor=\"white\"\n        onPress={onHandleNewOrUpdatedOrder}\n        disabled={buttonDisabled}\n      >\n        Confirmar R$ {order.productsPriceSum?.toFixed(2)}\n      </Button>\n    );\n  };\n\n  const completeDelivery = async () => {\n    if (order.id && order.deliveryId && order.userId) {\n      const completedOrder = await completeOrderDelivery(\n        user.id,\n        user.name,\n        delivery.id,\n        delivery.deliveryFee,\n        order\n      );\n      const orderUser = await findUserById(order.userId);\n      await createPaymentForUser(orderUser, completedOrder);\n      navigation.goBack(null);\n    }\n  };\n\n  const renderCompleteDeliveryButton = () => {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    delivery.deliveryDate?.setHours(0, 0, 0, 0);\n\n    if (\n      order.status != null &&\n      order.status === GLOBALS.ORDER.STATUS.COMPLETED\n    ) {\n      return (\n        <Button style={styles.disabledButton} textColor=\"white\" disabled>\n          Entrega concluída\n        </Button>\n      );\n    }\n\n    if (\n      today >= delivery.deliveryDate &&\n      !user.role &&\n      order.productsPriceSum > 0 &&\n      order.id\n    ) {\n      return (\n        <Button\n          style={styles.completeDeliveryButton}\n          textColor=\"white\"\n          onPress={() => completeDelivery()}\n        >\n          Concluir entrega\n        </Button>\n      );\n    }\n\n    return null;\n  };\n\n  const isLoading = () => {\n    return (\n      !order ||\n      !delivery ||\n      loading ||\n      deliveryLoading ||\n      userLoading ||\n      paymentLoading\n    );\n  };\n\n  return isLoading() ? (\n    <Spinner />\n  ) : (\n    <View style={styles.screen}>\n      <View style={styles.container}>\n        <View style={styles.baseProductsContainer}>\n          <View style={styles.baseProducts}>\n            <View style={styles.title}>\n              <Text\n                style={styles.textTitle}\n              >{`Cesta (${delivery.baseProductsPrice?.toFixed(2)})`}</Text>\n            </View>\n            <View style={styles.controls}>\n              <TouchableOpacity\n                style={styles.incDecButton}\n                onPress={() => removeBaseProducts(delivery.baseProductsPrice)}\n              >\n                {/* <Text style={styles.textControls}>{`-  `}</Text> */}\n                <Entypo name=\"minus\" size={24} color=\"#8898AA\" />\n              </TouchableOpacity>\n              <View style={styles.quantityContainer}>\n                <Text style={styles.quantity}>{order.baseProducts}</Text>\n              </View>\n              <TouchableOpacity\n                style={styles.incDecButton}\n                onPress={() => addBaseProducts(delivery.baseProductsPrice)}\n              >\n                {/* <Text style={styles.textControls}>{`  +`}</Text> */}\n                <Entypo name=\"plus\" size={24} color=\"#8898AA\" />\n              </TouchableOpacity>\n            </View>\n          </View>\n          <ScrollView style={styles.baseProductsItems}>\n            <Text style={styles.textItens}>\n              {formatBaseProducts(delivery.baseProducts)}\n            </Text>\n          </ScrollView>\n        </View>\n        <Divider style={{ borderBottomColor: Colors.secondary }} />\n        <View style={styles.extraProductsContainer}>\n          <View style={styles.title}>\n            <Text style={styles.textTitle}>Extras</Text>\n          </View>\n          <ScrollView style={styles.extraProducts}>\n            {orderProducts.map((item, index) => {\n              return (\n                <View key={index} style={styles.extraProductItems}>\n                  <View style={styles.line}>\n                    <View style={styles.itemContainer}>\n                      <Text style={styles.textItens}>\n                        {item.productTitle} (R${item.productPrice.toFixed(2)})\n                      </Text>\n                    </View>\n                  </View>\n                  <View style={styles.controls}>\n                    <View style={styles.incDecButton}>\n                      <TouchableOpacity\n                        onPress={() => removeProduct(orderProducts, item)}\n                      >\n                        <Entypo name=\"minus\" size={24} color=\"#8898AA\" />\n                      </TouchableOpacity>\n                    </View>\n                    <Text style={styles.quantity}>{item.quantity}</Text>\n                    <View style={styles.incDecButton}>\n                      <TouchableOpacity\n                        onPress={() =>\n                          addProduct(orderProducts, item, initialProducts)\n                        }\n                      >\n                        <Entypo name=\"plus\" size={24} color=\"#8898AA\" />\n                      </TouchableOpacity>\n                    </View>\n                  </View>\n                </View>\n              );\n            })}\n          </ScrollView>\n        </View>\n        <View style={styles.buttonContainer}>\n          <Divider style={{ borderBottomColor: Colors.secondary }} />\n          {renderConfirmButton()}\n          {renderCompleteDeliveryButton()}\n        </View>\n      </View>\n    </View>\n  );\n};\n\nexport const consumerOrderScreenOptions = (navData) => {\n  const { deliveryDate, user } = navData.route.params;\n  const headerTitle = isConsumer(user)\n    ? 'Fazer pedido'\n    : `Fazer pedido - ${user?.name}`;\n  // console.log(`navDataa${JSON.stringify(navData.route.params)}`);\n\n  return {\n    headerTitle: () => (\n      <View>\n        <View style={styles.header}>\n          <HeaderTitle title={headerTitle} />\n          <View style={styles.imageContainer}>\n            <Image style={styles.image} source={VegetableImage} />\n          </View>\n        </View>\n        <Text>Entrega da cesta - {deliveryDate}</Text>\n      </View>\n    ),\n    headerBackImage: () => <BackArrow />,\n    headerStyle: {\n      backgroundColor: 'transparent',\n      elevation: 0,\n      shadowOpacity: 0,\n      borderBottomWidth: 0,\n    },\n  };\n};\n\nconst styles = StyleSheet.create({\n  screen: {\n    flex: 1,\n    marginTop: 4,\n    backgroundColor: 'white',\n    borderTopLeftRadius: 20,\n    borderTopRightRadius: 20,\n    shadowColor: 'black',\n    shadowOpacity: 0.26,\n    shadowOffset: { width: 4, height: -3 },\n    shadowRadius: 8,\n    elevation: 25,\n  },\n  container: {\n    flex: 1,\n    marginLeft: 25,\n    marginRight: 25,\n    marginTop: 10,\n    marginBottom: 10,\n  },\n  baseProductsContainer: {\n    marginBottom: 10,\n    height: '20%',\n  },\n  baseProducts: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  baseProductsItems: {\n    // flexDirection: 'row',\n    // justifyContent: 'space-between',\n  },\n  title: {\n    flex: 1,\n    justifyContent: 'center',\n    height: 40,\n  },\n  textTitle: {\n    fontFamily: 'Roboto',\n    fontWeight: '700',\n    fontSize: 16,\n    color: '#505050',\n  },\n  controls: {\n    flexDirection: 'row',\n  },\n  incDecButton: {\n    width: 35,\n    height: 35,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  textControls: {\n    fontFamily: 'Roboto',\n    fontSize: 25,\n    fontWeight: 'bold',\n    color: '#8898AA',\n  },\n  quantityContainer: {\n    justifyContent: 'center',\n  },\n  quantity: {\n    fontSize: 20,\n    paddingLeft: 5,\n    paddingRight: 5,\n    borderBottomWidth: 2,\n    borderBottomColor: '#8898AA',\n    color: '#8898AA',\n  },\n  extraProductsContainer: {\n    marginTop: 10,\n    marginBottom: 10,\n    height: '63%',\n  },\n  line: {\n    flex: 1,\n    flexDirection: 'row',\n  },\n  itemContainer: {\n    justifyContent: 'center',\n  },\n  extraProducts: {\n    marginTop: 10,\n  },\n  extraProductItems: {\n    flex: 1,\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    paddingTop: 5,\n  },\n  textItens: {\n    fontFamily: 'Roboto',\n    fontWeight: '400',\n    fontSize: 16,\n    color: '#505050',\n  },\n  buttonContainer: {\n    position: 'absolute',\n    width: '100%',\n    bottom: 0,\n  },\n  confirmButton: {\n    marginTop: 5,\n    backgroundColor: Colors.primary,\n    justifyContent: 'space-between',\n  },\n  completeDeliveryButton: {\n    marginTop: 5,\n    backgroundColor: Colors.secondary,\n    justifyContent: 'space-between',\n  },\n  disabledButton: {\n    marginTop: 5,\n    backgroundColor: Colors.tertiary,\n    justifyContent: 'space-between',\n  },\n  header: {\n    alignItems: 'flex-start',\n  },\n  imageContainer: {\n    position: 'absolute',\n    right: -10,\n    width: 80,\n    height: 55,\n  },\n  image: {\n    width: '100%',\n    height: '100%',\n  },\n});\n\nexport default ConsumerOrderScreen;\n"]},"metadata":{},"sourceType":"module"}